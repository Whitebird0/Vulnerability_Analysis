# 前言

我们写一个弹框程序需要以下几个函数

MessageBoxA          user32.dll 

ExitProcess  		     kernel32.dll 

LoadLibraryA		    kernel32.dll  

GetProcAddress 	  kernel32.dll

程序在加载的函数会自动加载kernel32.dll，但是不会加载user32.dll ，所以需要我们用LoadLibraryA实现加载user32.dll

```c
 LoadLibrary("user32.dll")
```

然后我们才可以通过GetProcAddress或者遍历导出表得到MessageBoxA 

# 为什么需要计算hash

因为我们写shellcode的其中一个目标就是shellcode越小越好，如果使用字符串对比来遍历导出表会使shellcode变得比较大，所以使用hash就可以减轻代码量。

hash的算法暂时不要求理解

```c++
#include<stdio.h>
#include<windows.h>

DWORD GetHash(char *Fun_Name){
	DWORD digest=0;
	while(*Fun_Name){
		digest=((digest<<25)|(digest>>7));
		digest+=*Fun_Name;
		Fun_Name++;
	}	
	return digest;
}

void main(){
	DWORD hash;
	hash=GetHash("LoadLibraryA");
	printf("hash is %.8x\n",hash);
	hash=GetHash("ExitProcess");
	printf("hash is %.8x\n",hash);
	hash=GetHash("MessageBoxA");
	printf("hash is %.8x\n",hash);
} 
```



![](https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ截图20220404140803.png)
